---
title: "TextRank with pytextrank"
date: 2018-08-15
tags: [Machine Learning, TextRank, python, NLP]
excerpt: "TextRank is a graph based algorithm for Natural Language Processing that can be used for keyword and sentence extraction. The algorithm is inspired by PageRank which was used by Google to rank websites."
mathjax: "true"
---
### Introduction
[TextRank](https://web.eecs.umich.edu/~mihalcea/papers/mihalcea.emnlp04.pdf) is a graph based algorithm for Natural Language Processing that can be used for keyword and sentence extraction. The algorithm is inspired by [PageRank](https://en.wikipedia.org/wiki/PageRank) which was used by Google to rank websites. For a web page $$V_i$$, $$In(V_i)$$ is the set of webpages pointing to it while $$V_j$$ is the set of vertices $$V_i$$ points to. The rank of $$V_i$$ is defined as:   

$$S(V_i)= (1-d) + d * \sum_{j\in{In(V_i)}} \frac{S(V_j)}{|Out(V_j)|}$$

where d is a damping factor between 0 and 1.

In the case of text, the connections can be weighted so we introduce $$w_{ij}$$ which is the weight of the edge between entity $$V_i$$ and $$V_j$$. The weighed rank of $$V_i$$ now becomes:

$$WS(V_i)= (1-d) + d * \sum_{V_j\in{In(V_i)}} \frac{w_{ji}}{\sum_{V_k\in{Out(V_j)}}w_{jk}}WS(V_j)$$

We have the choice of using words, collocations, or even sentences as vertices of our graph. The same goes for the connection between the vertices.

### Keyword extraction
For keyword extraction we want to identify a subset of terms that best describe the text. We follow these steps:

1. Tokenize and annotate with Part of Speech (PoS). Only consider single words. No ngrams, multi-words are reconstructed later.
2. Use syntactic filter on all the lexical units (e.g. all words, nouns and verbs only).
3. Create and edge if lexical units co-occur within a window of N words to obtain an unweighted undirected graph.
4. Run the text rank algorithm to rank the words.
5. We take the top T lexical words.
6. Adjacent keywords are collapsed into a multi-word keyword.

### pytextrank
[pytextrank](https://github.com/ceteri/pytextrank) is a python implementation of TextRank, with some modifications as described on GitHub, notably verbs are included in the graph but not in the final keywords and lemmatization is used instead of stemming.
